import Code from '../../component/Code';
import WebStorageExample from '../../example/WebStorageExample';

# WebStorage

<WebStorageExample />

WebStorage gives you an easy to use binding for working with Web Storage i.e. LocalStorage and SessionStorage.

It can only store data that is **serializable** and stored as a string, such as via `JSON.stringify()`.

It is **uncontrolled**, meaning that it only reads from storage on initial mount. Changes are saved, but hocs are not updated if the storage changes while mounted.

*TODO: In future, [this will be able to be controlled](https://github.com/blueflag/react-cool-storage/issues/4)*

<Code language="jsx">{`
import WebStorage from 'react-cool-storage/WebStorage';

WebStorage({
    key: string,
    // optional
    method?: string = "localStorage",
    deconstruct?: Function,
    reconstruct?: Function,
    parse?: (data: string) => any,
    stringify?: (data: any) => string
})
`}</Code>

- `key` - A globally unique key that will be used to store the data in web storage.
- `method` - The `history` method to use. Can be "localStorage" or "sessionStorage". Defaults to "localStorage".
- `deconstruct` - A function that is called before WebStorage stringifies data when a change occurs. This provides an opportunity to convert custom data types into simpler ones before stringification takes place. Defaults to a passthrough function.
- `reconstruct` - A function that is called after WebStorage has parsed its data. It is given the parsed object. This provides an opportunity to convert data into custom data types before its is received by the hoc's child component. Defaults to a passthrough function.
- `parse` - A function that is called on the value of each key / value pair to turn it from a string into a data shape. Defaults to `JSON.parse()`.
- `stringify` - A function that is called on the value of each key / value pair to turn it from a data shape into a string. Defaults to `JSON.stringify()`.

## Resources
WebStorage requires `window.localStorage` or `window.sessionStorage` to be available, depending on the `method` you choose.

This generally means that the browser must support web storage, allow its use, and have sufficient storage space.

## Props
WebStorage requires no props.

## Example

<Code language="jsx">{`
import React from 'react';
import ReactCoolStorageHoc from 'react-cool-storage';
import WebStorage from 'react-cool-storage/WebStorage';

const WebStorageExample = (props) => {
    let {webStorage} = props;
    return <div>
        <label>localStorage data stored under a key of "exampleStorage.foo"</label>
        <input
            value={webStorage.value.foo || ""}
            onChange={(event) => webStorage.onChange({
                foo: event.currentTarget.value
            })}
        />
        <label>localStorage data stored under a key of "exampleStorage.bar"</label>
        <input
            value={webStorage.value.bar || ""}
            onChange={(event) => webStorage.onChange({
                bar: event.currentTarget.value
            })}
        />
    </div>;
};

export default ReactCoolStorageHoc(
    'webStorage',
    WebStorage({
        key: 'exampleStorage'
    })
)(WebStorageExample);
`}</Code>
